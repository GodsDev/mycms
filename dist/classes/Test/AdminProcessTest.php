<?php

namespace GodsDev\MYCMSPROJECTNAME;

use GodsDev\MyCMS\MyCMS;
use Tracy\Debugger;

require_once __DIR__ . '/../../conf/env_config.php';

/**
 * Generated by PHPUnit_SkeletonGenerator on 2018-02-04 at 08:10:54.
 */
class AdminProcessTest extends \PHPUnit_Framework_TestCase
{

    /**
     * @var MyCMS
     */
    protected $myCms;

    /**
     * @var AdminProcess
     */
    protected $object;

    /**
     * Sets up the fixture, for example, opens a network connection.
     * This method is called before a test is executed.
     */
    protected function setUp()
    {
        global $backyardConf;
        Debugger::enable(Debugger::DEVELOPMENT, __DIR__ . '/../../log');
        $backyard = new \GodsDev\Backyard\Backyard($backyardConf);
        $mycmsOptions = array(
            'TRANSLATIONS' => array(
                'en' => 'English',
                'cn' => '中文'
            ),
            'logger' => $backyard->BackyardError,
            'dbms' => new \GodsDev\Backyard\BackyardMysqli(DB_HOST . ":" . DB_PORT, DB_USERNAME, DB_PASSWORD, DB_DATABASE, $backyard->BackyardError), //@todo - use test db instead. Or use other TAB_PREFIX !
        );
        $this->myCms = new MyCMS($mycmsOptions);
        $_SESSION = array(
            'language' => $this->myCms->getSessionLanguage(array(), array(), false),
            'token' => rand(1e8, 1e9),
        ); //because $_SESSION is not defined in the PHPUnit mode
        $AGENDAS = array(
            'category' => array('path' => 'path'),
            //        'page' => array('table' => 'content', 'where' => 'type="page"', 'prefill' => array('type' => 'page')),
            'press' => array('table' => 'content', 'where' => 'type="press"', 'prefill' => array('type' => 'press')),
            'slide' => array('table' => 'content', 'where' => 'type="slide"', 'column' => 'content_' . DEFAULT_LANGUAGE, 'prefill' => array('type' => 'slide')),
            'claim' => array('table' => 'content', 'where' => 'type="claim"', 'column' => 'description_' . DEFAULT_LANGUAGE, 'prefill' => array('type' => 'claim')),
            'testimonial' => array('table' => 'content', 'where' => 'type="testimonial"', 'column' => 'description_' . DEFAULT_LANGUAGE, 'prefill' => array('type' => 'testimonial')),
            'system' => array('table' => 'content', 'where' => 'type="system"', 'column' => 'code', 'prefill' => array('type' => 'system'))
        );
        //maybe according to what you test, change $this->myCms->context before invoking $this->object = new Admin; within Test methods        
        $this->object = new AdminProcess($this->myCms, array('agendas' => $AGENDAS));
    }

    /**
     * Tears down the fixture, for example, closes a network connection.
     * This method is called after a test is executed.
     */
    protected function tearDown()
    {
        
    }

    /**
     * @covers GodsDev\MYCMSPROJECTNAME\AdminProcess::adminProcess
     * @todo   Implement testAdminProcess().
     */
    public function testAdminProcess()
    {
        // Remove the following lines when you implement this test.
        $this->markTestIncomplete(
                __FUNCTION__ . ' has not been implemented yet.'
        );
    }

    /**
     * @covers GodsDev\MYCMSPROJECTNAME\AdminProcess::getAgenda
     */
    public function testGetAgenda()
    {
        $adminAgendaCategoryArray = $this->object->getAgenda("category");
        $this->assertEquals(array('id' => '10', 'name' => 'MYCMSPROJECTNAME', 'path' => '0000000001'), $adminAgendaCategoryArray[0]);
    }

}
